---
title: "Chapter 02 단순선형회귀"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```

## 2.0 library

```{r}
library(ggplot2)
```

## 2.3 

```{r, echo=FALSE}
df2_5 = read.table("https://www1.aucegypt.edu/faculty/hadi/RABE5/Data5/P031.txt", header = T)
knitr::kable(df2_5)
```

```{r}
df2_5 = read.table("https://www1.aucegypt.edu/faculty/hadi/RABE5/Data5/P031.txt", header = T)
ggplot(data = df2_5, aes(x = Units, y = Minutes)) + 
    geom_point()
cor(df2_5$Minutes, df2_5$Units)
```

## 2.5 

모형적합은 `lm(Y~X)`을 이용하여 할 수 있다.

```{r}
fit2_5 = lm(Minutes ~ Units, data = df2_5)
fit2_5$coefficients
```

$$
\text{Minutes} = 4.162 + 15.509 \cdot \text{Units}
$$

적합값과 잔차는 다음과 같다.

```{r}
fit2_5$fitted.values
fit2_5$residuals
```

## 2.6

$\hat{\sigma}$은 다음과 같다.

```{r}
summary(fit2_5)$sigma
```


각 회귀계수가 $0$이라는 가설검정의 결과는 다음과 같다.

```{r}
summary(fit2_5)
```

## 2.7

회귀계수에 대한 $95\%$ 신뢰구간은 다음과 같다.

```{r}
confint(fit2_5, "Units", level = 0.95)
confint(fit2_5, "(Intercept)", level = 0.95)
confint(fit2_5, level = 0.95)
```

## 2.8 

$x=4$인 경우의 예측값은 다음과 같다.

```{r}
predict(fit2_5, newdata = data.frame(Units = 4))
```

예측에 대한 신뢰구간은 다음과 같다.

```{r}
predict(fit2_5, newdata = data.frame(Units = 4), interval = "prediction")
```

평균반응에 대한 신뢰구간은 다음과 같다.

```{r}
predict(fit2_5, newdata = data.frame(Units = 4), interval = "confidence")
```

## 2.9

결정계수는 다음과 같다.

```{r}
summary(fit2_5)$r.squared
```

## 2.10

원점을 통과하는 회귀모형의 결과를 구할 때는 `lm(Y ~ X - 1)`을 이용한다.

## 2.11

예측변수를 가지지 않는 회귀모형의 결과를 구할 때는 `lm(Y ~ 1)`을 이용한다. 

# 연습문제

## 2.10

```{r}
df2_10 = read.table("https://www1.aucegypt.edu/faculty/hadi/RABE5/Data5/P052.txt", header = T)
```

### (a)

```{r}
cov(df2_10$Husband, df2_10$Wife)
```

### (b)

```{r}
cov(df2_10$Husband / 100, df2_10$Wife / 100)
```

### (c)

```{r}
cor(df2_10$Husband, df2_10$Wife)
```

### (d)

```{r}
cor(df2_10$Husband / 100, df2_10$Wife / 100)
```

### (e)

```{r}
cor(df2_10$Husband, df2_10$Husband - 5)
```

### (f)

사회적 통념에 의하면 남자가 여자에게 고백을 하고 결혼하므로 남자를 예측변수, 여자를 반응변수로 선택한다. 물론 이 문제의 정답은 없다고 본다.

### (g), (h)

```{r}
fit2_10 = lm(Wife ~ Husband, data = df2_10)
summary(fit2_10)
```

$p-value$가 작으므로 기울기가 $0$이라는 귀무가설을 기각한다. 

$p-value$가 작으므로 절편항이 $0$이라는 귀무가설을 기각한다. 

## 2.12

```{r}
df2_12 = read.table("https://www1.aucegypt.edu/faculty/hadi/RABE5/Data5/P054.txt", 
                    header = T, sep = "\t")
```

### (a)

```{r}
ggplot(data = df2_12, aes(x = Daily, y = Sunday)) + geom_point()
```

충분히 선형관계라고 생각된다.

### (b)

```{r}
fit2_12 = lm(Sunday ~ Daily, data = df2_12)
fit2_12$coefficients
```

$$
\text{Sunday}= 13.836 + 1.340 \cdot \text{Daily}
$$

### (c)

```{r}
confint(fit2_12)
```

### (d)

귀무가설: 기울기가 $0$이다.

대립가설: 기울기가 $0$이 아니다.

```{r}
summary(fit2_12)
```

$p-value$가 작으므로 귀무가설을 기각한다. 즉, 일요일 판매부수와 주중 판매부수 사이에 유의한 관계가 있다.

### (e)

```{r}
summary(fit2_12)$r.squared
```

### (f)

```{r}
predict(fit2_12, newdata = data.frame(Daily = 500000), interval = "confidence")
```

### (g)

```{r}
predict(fit2_12, newdata = data.frame(Daily = 500000), interval = "prediction")
```

(f)에서 구한 결과보다 넓다.

### (h)

```{r}
predict(fit2_12, newdata = data.frame(Daily = 2000000), interval = "prediction")
```

(g)에서 구한 결과보다 넓다. 
이 결과는 주어진 데이터와 멀리 떨어진 값에 대하여 예측을 하므로 부정확한 결과일 것이다.


